# 変更履歴 (Changelog)

本プロジェクトの主要な変更点をここに記録します。

## [1.3.1] - 2026-01-02 コードベースリファクタリング

### 変更 - アーキテクチャ

- **semantic モジュール分割**:
  - `type_infer.rs`: 型推論ロジック (TypeInferenceトレイト)
  - `operators.rs`: 演算子変換ロジック
  - `coercion.rs`: 型変換・強制判定
  - `builtins.rs`: 組み込み関数テーブル駆動管理

- **IR モジュール分割**:
  - `ops.rs`: 演算子定義 (IrBinOp, IrUnaryOp, IrAugAssignOp)
  - `exprs.rs`: 式定義 (IrExpr)
  - `nodes.rs`: ステートメント定義 (IrNode)

- **bridge/strategies 追加**:
  - ImportStrategy トレイト: インポート方式の抽象化
  - NativeStrategy: Rustネイティブ実装 (math系)
  - PyO3Strategy: 将来のPyO3直接呼び出し用 (空箱)
  - ResidentStrategy: 常駐プロセスフォールバック

### 変更 - 責務分離

- `IrExpr::Cast`: int/float型キャストをsemantic側で生成
- `IrExpr::StructConstruct`: struct構築をsemantic側で判定
- emitter側の重複コード26行削減

### テスト

- ユニットテスト: 91件 (+19)
- リグレッションテスト: 51件全パス維持

## [1.3.0] - 2026-01-01 基本構文徹底サポート

### 追加 - 演算子

- **`@` 行列演算子**: NumPy 行列乗算に対応
- **`not in` 演算子**: コンテナ非包含チェックに対応
- **ビット演算子**: `&`, `|`, `^`, `~`, `<<`, `>>` に対応
- **ビット累算代入**: `&=`, `|=`, `^=`, `<<=`, `>>=` に対応
- **`**=` 累乗代入**: 累乗の累算代入に対応

### 追加 - 組み込み関数

- **`enumerate`**: インデックス付きイテレーションに対応
- **`zip`**: 複数イテラブルの並列イテレーションに対応
- **`sorted`**: ソート済みリスト生成に対応
- **`reversed`**: 逆順イテレーションに対応
- **`sum`**: 合計計算に対応
- **`all` / `any`**: 全要素/任意要素の真偽判定に対応
- **`map` / `filter`**: 関数型イテレータに対応
- **`assert`**: アサーション文に対応

### 追加 - リストメソッド

- **`.sort()`**: インプレースソートに対応
- **`.reverse()`**: インプレース逆順に対応
- **`.index()`**: 要素の位置検索に対応
- **`.count()`**: 要素の出現回数カウントに対応

### 追加 - その他

- **辞書内包表記**: `{k: v for k, v in items}` に対応
- **多重代入の強化**: `a, b, c = 1, 2, 3` の完全サポート

## [1.2.0] - 2025-12-31

### 追加 (Added)
- **常駐プロセス方式 (Resident Python Worker)**: NumPy や Pandas などの複雑なライブラリを、IPC 経由で常駐プロセスとして呼び出す新アーキテクチャを追加。これにより PyO3 のバイナリ互換性問題を解決。
- **Dataclass 対応**: `@dataclass` デコレータの部分的なサポートを追加。
- **リストのコピー**: `list.copy()` メソッドに対応（`.to_vec()` に変換）。
- **デフォルト引数**: 関数定義におけるデフォルト引数に対応。
- **F-string デバッグ**: f-string 内での `"{:?}"` フォーマット指定に対応。

### 変更 (Changed)
- **型推論**: 変数代入や戻り値の型推論精度を向上。
- **アーリーリターン**: 関数内の早期リターン処理ロジックを改善。
- **インポート戦略**: 最適な変換戦略を選択するハイブリッド方式 (Native > Resident > PyO3) を導入。

## [1.1.0] - 2025-12-29

### 変更 (Changed)
- **演算子の改善**: `is` / `is not` 演算子を修正し、`Option` 型を正しく扱えるように改善。
- **ドキュメント**: ドキュメント構成を見直し、英語版 (`README.md`) と日本語版 (`README_jp.md`) に分離。

### 追加 (Added)
- **機能ドキュメント**: `supported_features.md` および `unsupported_features.md` を追加。
